<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact — Kulsum Huda</title>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
  <header class="nav"><a class="brand" href="/">KH</a></header>
  <main style="padding:24px;max-width:700px;margin:0 auto">
    <h1>Contact</h1>
    <p>Please fill in the form below. Submissions will be sent to the configured Google Sheets endpoint if set in the Admin; otherwise they are stored locally and can be exported from the Admin.</p>
    <form id="contactForm" style="display:grid;gap:8px;max-width:480px">
      <input id="c_name" placeholder="Your name" required />
      <input id="c_email" type="email" placeholder="Your email" required />
      <input id="c_phone" placeholder="Phone (optional)" />
      <textarea id="c_msg" rows="4" placeholder="Message" required></textarea>
      <button type="submit">Send</button>
    </form>
    <p id="contactStatus" style="color:green"></p>
  </main>
  <script src="assets/js/main.js"></script>
  <script>
    document.getElementById('contactForm').onsubmit = async (ev)=>{
      ev.preventDefault();
      const data = {
        name: document.getElementById('c_name').value.trim(),
        email: document.getElementById('c_email').value.trim(),
        phone: document.getElementById('c_phone').value.trim(),
        message: document.getElementById('c_msg').value.trim(),
        ts: new Date().toISOString()
      };
      const settings = JSON.parse(localStorage.getItem('kh_settings')||'{}');
      const statusEl = document.getElementById('contactStatus');
      if(settings.sheetsEndpoint){
        try{
          const r = await fetch(settings.sheetsEndpoint, {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
          if(r.ok){ statusEl.textContent = 'Thanks — we received your message.'; return; }
        }catch(e){ console.warn(e); }
      }
      // fallback: save locally and inform user
      const arr = JSON.parse(localStorage.getItem('kh_submissions')||'[]'); arr.push(data); localStorage.setItem('kh_submissions', JSON.stringify(arr));
      statusEl.textContent = 'Thanks — message saved locally. Admin can export submissions as CSV.';
    };
  </script>
</body>
</html>
